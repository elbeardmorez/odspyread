
# odspyread

## description

python script to extract data from an ods format spreadsheet. handles multiple tables per sheet. optionally search for a value in a specified index/field and dump a selection/all fields' data for the records found

## dependencies
-odfpy

## help

Usage: odspyread.py [options]

Options:
  -h, --help            show this help message and exit
  -d DOC, --document=DOC
                        the spreadsheet path
  -e SHEET, --sheet=SHEET
                        [optional] sheet name of interest [default: first
                        sheet]
  -i IDX, --idx=IDX     [optional] name of the index/key field for searching
                        in
  -s SEARCH, --search=SEARCH
                        [optional] comma-delimited list of value(s) to search
                        for in the index/key field [default: *]
  -m, --allow-duplicates
                        [optional] continue searching for duplicates after
                        match [default: false]
  -f FIELDS, --fields=FIELDS
                        [optional] comma delimited list of field(s) to extract
                        data from [default: *]
  -r HEADERROWSTART, --header-row=HEADERROWSTART
                        [optional] row number for specifying table location
                        where multiple tables exist in a sheet [default: 1]
  -c HEADERCOLUMNSTART, --header-column=HEADERCOLUMNSTART
                        [optional] column number for specifying table location
                        where multiple tables exist in a sheet [default: 1]
  -l DELIMITER, --delimiter=DELIMITER
                        [optional] change the data output delimiter [default:
                        ' | ']
  -v VERBOSITY, --verbosity=VERBOSITY
                        log level [default: 1]

## examples

the following examples are based on the content of 'test.odf':

*search for 'search 2' record under field 'header 3 idx'
> ./odspyread.py -d test.ods -i "header 3 idx" -s "search 2"

header 1 | header 2 | header 3 idx | header 4 | header 5
 | data1 2 2 | search 2 |  |

*dump a table which exists at some offset in the sheet
>./odspyread.py -d test.ods -r 10 -c 5

header 1 | header 2 idx | header 2 | header 4
 | search 1 |  |
 | search 2 | data3 2 2 |
 | search 3 |  | data3 3 4

*search for 'search2' in sheet 'test' in the first table found beyond row 9, returning data for fields 'header1 idx' and 'header 3' only, delimited by ','
>./odspyread.py -d test.ods -r 9 -i 'header 1 idx' -s 'search 2' -f 'header 1 idx,header 3' -l ','

header 1 idx,header 3
search 2,data2 2 3

## todo
-regexp search switch
-ignore prefix/filter
-handle non-existent fields

